
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Methankrieg ‚Äì Szenarioauswahl & Spiel</title>

  <!-- ‚úÖ Zentrale CSS-Datei -->
  <link rel="stylesheet" href="karte.css">

  <!-- ‚úÖ Zoom-Tool (Panzoom) -->
  <script src="https://cdn.jsdelivr.net/npm/@panzoom/panzoom@4.5.1/dist/panzoom.min.js"></script>

  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: white;
      font-family: sans-serif;
    }
    #auswahlbereich {
      padding: 40px;
      background: #f4f4f4;
    }
    #spielbereich {
      display: none;
      height: 100%;
    }
    #container {
      width: 100%;
      height: calc(100% - 30px);
    }
    #svgwrapper {
      width: 100%;
      height: 100%;
    }
    svg {
      width: 100%;
      height: 100%;
    }
    #log {
      height: 30px;
      line-height: 30px;
      background: #eee;
      border-top: 1px solid #ccc;
      padding-left: 10px;
      font-size: 14px;
    }
    .selected {
      stroke: orange;
      stroke-width: 3;
    }
  </style>
</head>

<body>
  <!-- üéØ Auswahlbereich -->
  <div id="auswahlbereich">
    <h1>Szenario w√§hlen</h1>
    <select id="szenarioAuswahl">
      <option value="umkaempftes_casyat">Umk√§mpftes Casyat</option>
      <option value="vorstoss_erkud">Vorsto√ü nach Erkud</option>
      <option value="trantor_verteidigen">Verteidigung von Trantor</option>
    </select>
    <button onclick="spielStarten()">Spiel starten</button>
  </div>

  <!-- üéÆ Spielbereich -->
  <div id="spielbereich">
    <div id="container">
      <div id="svgwrapper"></div>
    </div>
    <div id="log">[DEBUG] System bereit.</div>

    <div id="detailpanel-container" style="
      position: absolute;
      top: 0;
      right: 0;
      width: 320px;
      height: 100%;
      background: white;
      border-left: 1px solid #ccc;
      display: none;
      z-index: 2000;
      box-shadow: -2px 0 5px rgba(0,0,0,0.2);">
      <button onclick="document.getElementById('detailpanel-container').style.display='none'"
              style="position:absolute; top:10px; right:10px; z-index:2100;">
        ‚úñ
      </button>
      <iframe id="detailpanel-frame" src="" style="width: 100%; height: 100%; border: none;"></iframe>
    </div>
  </div>

  <!-- üì¶ Spiel-Skripte -->
  <script src="gameState.js"></script>
  <script src="lade_datenbanken.js"></script>
  <script src="kartenloader.js"></script>
  <script src="bewegungslogik.js"></script>
  <script src="marker_movement.js"></script>
  <script src="kontextaktionen.js"></script>
  <script src="kontextmenu.js"></script>
  <script src="aktualisiereHexfeldStile.js"></script>
  <script src="sprungrouten_anzeige.js"></script>

  <script>
  async function spielStarten() {
    // üéØ Szenario aus Dropdown holen
    const szenario = document.getElementById("szenarioAuswahl").value;

    // ‚úÖ GameState vorbereiten
    window.gameState = {
      ziele: {
        szenario: szenario
      }
    };

    // üí¨ Auswahlbereich ausblenden, Spielbereich einblenden
    document.getElementById("auswahlbereich").style.display = "none";
    document.getElementById("spielbereich").style.display = "block";

    // üîÅ Spielmodule initialisieren
    await ladeDatenbanken(); // JSON-Daten laden
    const svg = await ladeKarte("Karte_Sektor_F_v1.svg", "svgwrapper"); // SVG laden

    if (svg) {
      initialisiereKontextmenu(svg);

      if (typeof aktualisiereHexfeldStile === "function") {
        aktualisiereHexfeldStile(svg);
      }
      if (typeof zeichneSprungrouten === "function" && typeof sprungrouten_datenbank !== "undefined") {
        zeichneSprungrouten(svg, sprungrouten_datenbank);
      }
    }

    console.log("[INIT] Karte, Men√º, Stile und Sprungrouten initialisiert.");
  }
</script>

</body>
</html>
